<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Quiz - Master the Numbers</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #67b26f;
            --accent: #f39c12;
            --danger: #e74c3c;
            --dark: #2c3e50;
            --light: #f4f7f6;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0; color: var(--dark);
        }

        #game-container {
            background: white; width: 90%; max-width: 500px;
            border-radius: 20px; padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            text-align: center; position: relative; overflow: hidden;
        }

        /* UI Elements */
        .header-info { display: flex; justify-content: space-between; margin-bottom: 20px; font-weight: bold; }
        .timer-bar {
            width: 100%; height: 8px; background: #eee;
            border-radius: 4px; margin-bottom: 20px; overflow: hidden;
        }
        #progress {
            width: 100%; height: 100%; background: var(--primary);
            transition: width 0.1s linear;
        }

        .question-box h2 { font-size: 1.2rem; color: #555; }
        .math-expr { font-size: 3rem; margin: 20px 0; font-weight: 800; color: var(--dark); }

        .options-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
        }

        button {
            padding: 15px; border: 2px solid #eee; border-radius: 12px;
            background: white; cursor: pointer; font-size: 1.1rem;
            transition: all 0.2s; font-weight: 600;
        }

        button:hover { border-color: var(--primary); background: #f0f7ff; }
        button:active { transform: scale(0.98); }

        /* Screens */
        .screen { display: none; }
        .active { display: block; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Badges */
        .badge-pill {
            display: inline-block; padding: 5px 15px; border-radius: 20px;
            background: var(--accent); color: white; font-size: 0.8rem; margin: 5px;
        }

        .stats-final { font-size: 1.2rem; margin: 20px 0; }
        .btn-main {
            background: var(--primary); color: white; border: none;
            padding: 15px 40px; font-size: 1.2rem; margin-top: 20px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="start-screen" class="screen active">
        <h1>Math Quiz ðŸ§®</h1>
        <p>Jawab 10 soal secepat mungkin!<br>Level akan meningkat seiring poinmu bertambah.</p>
        <button class="btn-main" onclick="startGame()">Mulai Game</button>
    </div>

    <div id="game-screen" class="screen">
        <div class="header-info">
            <span>Poin: <span id="score">0</span></span>
            <span id="level-tag">Level: 1</span>
            <span>Soal: <span id="q-count">1</span>/10</span>
        </div>
        <div class="timer-bar"><div id="progress"></div></div>
        <div class="question-box">
            <h2 id="streak-info">Ayo Fokus!</h2>
            <div class="math-expr" id="expression">2 + 2</div>
            <div class="options-grid" id="options">
                </div>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <h1>Permainan Selesai!</h1>
        <div class="stats-final">
            Skor Akhir: <strong id="final-score">0</strong><br>
            <div id="badges-container" style="margin-top: 15px;"></div>
        </div>
        <button class="btn-main" onclick="location.reload()">Main Lagi</button>
    </div>
</div>

<script>
    let score = 0;
    let currentQuestion = 1;
    let correctAnswer = 0;
    let timer;
    let timeLeft = 30;
    let streak = 0;
    let quickAnswerCount = 0;

    const expressionEl = document.getElementById('expression');
    const optionsEl = document.getElementById('options');
    const scoreEl = document.getElementById('score');
    const qCountEl = document.getElementById('q-count');
    const levelTag = document.getElementById('level-tag');
    const progressEl = document.getElementById('progress');

    function startGame() {
        showScreen('game-screen');
        nextQuestion();
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function nextQuestion() {
        if (currentQuestion > 10) return endGame();
        
        qCountEl.innerText = currentQuestion;
        generateMath();
        startTimer();
    }

    function generateMath() {
        // Level Logic: Level 2 (poin > 50) menggunakan angka lebih besar dan perkalian
        let isHard = score > 50;
        levelTag.innerText = isHard ? "Level: 2 (Sulit)" : "Level: 1 (Mudah)";
        
        let num1 = isHard ? Math.floor(Math.random() * 20) + 10 : Math.floor(Math.random() * 10) + 1;
        let num2 = isHard ? Math.floor(Math.random() * 15) + 1 : Math.floor(Math.random() * 10) + 1;
        let ops = isHard ? ['+', '-', '*'] : ['+', '-'];
        let op = ops[Math.floor(Math.random() * ops.length)];

        expressionEl.innerText = `${num1} ${op} ${num2}`;
        correctAnswer = eval(`${num1}${op}${num2}`);

        // Generate Options
        let choices = [correctAnswer];
        while(choices.length < 4) {
            let rand = correctAnswer + (Math.floor(Math.random() * 10) - 5);
            if(!choices.includes(rand)) choices.push(rand);
        }
        choices.sort(() => Math.random() - 0.5);

        optionsEl.innerHTML = '';
        choices.forEach(val => {
            const btn = document.createElement('button');
            btn.innerText = val;
            btn.onclick = () => checkAnswer(val);
            optionsEl.appendChild(btn);
        });
    }

    function startTimer() {
        clearInterval(timer);
        timeLeft = 30;
        progressEl.style.width = '100%';
        
        timer = setInterval(() => {
            timeLeft -= 0.1;
            progressEl.style.width = (timeLeft / 30 * 100) + '%';
            if (timeLeft <= 0) {
                clearInterval(timer);
                checkAnswer(null); // Timeout dianggap salah
            }
        }, 100);
    }

    function checkAnswer(val) {
        clearInterval(timer);
        const startTime = Date.now();

        if (val === correctAnswer) {
            score += 10;
            streak++;
            if(timeLeft > 20) quickAnswerCount++; // Bonus kriteria untuk Quick Thinker
            
            if(streak >= 3) {
                document.getElementById('streak-info').innerText = "ðŸ”¥ On Fire! (Streak 3+)";
                document.getElementById('streak-info').style.color = "orange";
            }
        } else {
            streak = 0;
            document.getElementById('streak-info').innerText = "Ayo Fokus!";
            document.getElementById('streak-info').style.color = "#555";
        }

        scoreEl.innerText = score;
        currentQuestion++;
        
        // Animasi feedback singkat sebelum soal berikutnya
        optionsEl.style.pointerEvents = 'none';
        setTimeout(() => {
            optionsEl.style.pointerEvents = 'auto';
            nextQuestion();
        }, 500);
    }

    function endGame() {
        showScreen('result-screen');
        document.getElementById('final-score').innerText = score;
        
        const badgeBox = document.getElementById('badges-container');
        badgeBox.innerHTML = '';

        if(score >= 80) {
            badgeBox.innerHTML += `<span class="badge-pill">ðŸŒŸ Math Star</span>`;
        }
        if(quickAnswerCount >= 5) {
            badgeBox.innerHTML += `<span class="badge-pill">âš¡ Quick Thinker</span>`;
        }
        if(score < 50 && score > 0) {
            badgeBox.innerHTML += `<span class="badge-pill">ðŸ“š Keep Learning</span>`;
        }
    }
</script>

</body>
</html>